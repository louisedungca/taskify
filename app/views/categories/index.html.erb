<h1>Welcome, <%= current_user.email %></h1>

<h1>Dashboard</h1>

<div class="flex justify-between gap-4">
  <% @categories.each do |category| %>  
    <div class="w-[350px] h-full border-2 border-slate-950 rounded-xl">

      <div class="bg-primary rounded-t-lg p-4 text-purple-50 font-bold flex justify-between items-center gap-3">
        <%= link_to category.category_name, category %>   

        <div class="flex justify-center items-center gap-3">   
          <%= link_to "Edit", edit_category_path(category) %>
          <%= link_to "Delete", category_path(category), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to permanently delete this category?" } %>
        </div>
      </div>

      <div class="min-h-[250px] flex flex-col gap-2 p-2">   
        <%= link_to "Add Task", category_path(category) %>

        <% category.tasks.each do |task| %>
          <% if task.id.present? && task.is_completed == false %>
            <%= render partial: "tasks/show_task", locals: { task: task } %>
          <% end %>
        <% end %>
        
        <% if category.tasks.any?(&:is_completed) %>
          <p>Completed:</p>
          <% category.tasks.each do |task| %>
            <% if task.id.present? && task.is_completed == true %>
              <%= render partial: "tasks/show_task", locals: { task: task } %>
            <% end %>
          <% end %>
        <% end %>        
      </div>

    </div>
  <% end %>
</div>

<div class="sharedlinks__bottom sm:w-1/5">
  <%= link_to "New Category", new_category_path, class: "actions btn--main" %>
  <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "actions btn--subv2" %>
</div>